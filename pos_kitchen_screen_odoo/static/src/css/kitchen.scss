@charset "UTF-8";

/* ─────────────────────────────────────────────────────────
   THEME TOKENS (Light = default). Put data-theme="dark" on
   <html>, <body>, or .kitchen-dashboard to switch.
   ───────────────────────────────────────────────────────── */

/* ========== LIGHT (default) ========== */
:root,
body,
.kitchen-dashboard {
  --k-brand: #c1d963;
  --k-brand-ink: #26300f;

  --k-bg: #f5f7fa;
  --k-surface: #ffffff;
  --k-text: #2c3e50;
  --k-muted: #64748b;

  --k-card-inprogress: #edeff5;
  --k-card-inprogress-hover: #e3e7f0;

  --k-card-completed: #c1d963;        /* brand green */
  --k-card-completed-hover: #b7cf56;
  --k-completed-ink: #26300f;

  --k-header-offline: #34495e;
  --k-header-online: #5b80a4;

  --k-btn-primary-bg: var(--k-brand);
  --k-btn-primary-ink: #0b1220;
  --k-btn-danger-bg: #e74c3c;
  --k-btn-danger-ink: #ffffff;

  --k-shadow: 0 10px 30px rgba(17, 24, 39, 0.12);
  --k-radius: 16px;
  --k-spacing: 1rem;

  --k-title-inprogress: var(--k-text);
  --k-title-completed: var(--k-text);

  --k-line-bg: #eef2f6;
  --k-line-border: rgba(0, 0, 0, 0.08);
  --k-line-color: #2c3e50;
}

/* ========== DARK (support data-theme, data-bs-theme, and Odoo flags) ========== */
html[data-theme="dark"],
html[data-bs-theme="dark"],
body[data-theme="dark"],
body[data-bs-theme="dark"],
.o_web_client.o_dark,
.o_web_client[data-bs-theme="dark"],
.kitchen-dashboard[data-theme="dark"] {
  --k-bg: #0b1220;
  --k-surface: #0f172a;
  --k-text: #e5e7eb;
  --k-muted: #a8b1c7;

  --k-card-inprogress: rgba(255, 255, 255, 0.08);
  --k-card-inprogress-hover: rgba(255, 255, 255, 0.14);

  --k-card-completed: #c1d963;
  --k-card-completed-hover: #b7cf56;
  --k-completed-ink: #26300f;

  --k-header-offline: #2a3647;
  --k-header-online: #3f5c77;

  --k-btn-primary-bg: #b6cf59;
  --k-btn-primary-ink: #0b1220;

  --k-shadow: 0 12px 36px rgba(0, 0, 0, 0.28);

  --k-title-inprogress: #ffffff;
  --k-title-completed: #ffffff;

  --k-line-bg: rgba(255, 255, 255, 0.06);
  --k-line-border: rgba(255, 255, 255, 0.10);
  --k-line-color: #e5e7eb;
}

/* ========== OS fallback when no explicit theme is set ========== */
@media (prefers-color-scheme: dark) {
  html:not([data-theme]):not([data-bs-theme]),
  body:not([data-theme]):not([data-bs-theme]),
  .kitchen-dashboard:not([data-theme]) {
    --k-bg: #0b1220;
    --k-surface: #0f172a;
    --k-text: #e5e7eb;
    --k-muted: #a8b1c7;

    --k-card-inprogress: rgba(255, 255, 255, 0.08);
    --k-card-inprogress-hover: rgba(255, 255, 255, 0.14);

    --k-card-completed: #c1d963;
    --k-card-completed-hover: #b7cf56;
    --k-completed-ink: #26300f;

    --k-header-offline: #2a3647;
    --k-header-online: #3f5c77;

    --k-btn-primary-bg: #b6cf59;
    --k-btn-primary-ink: #0b1220;

    --k-shadow: 0 12px 36px rgba(0, 0, 0, 0.28);

    --k-title-inprogress: #ffffff;
    --k-title-completed: #ffffff;

    --k-line-bg: rgba(255, 255, 255, 0.06);
    --k-line-border: rgba(255, 255, 255, 0.10);
    --k-line-color: #e5e7eb;
  }
}


/* ─────────────────────────────────────────────────────────
   SCSS bridges & helpers
   ───────────────────────────────────────────────────────── */
$brand: var(--k-brand);
$brand-ink: var(--k-brand-ink);
$bg: var(--k-bg);
$surface: var(--k-surface);
$text: var(--k-text);
$muted: var(--k-muted);

$inprogress: var(--k-card-inprogress);
$inprogress-hover: var(--k-card-inprogress-hover);
$completed: var(--k-card-completed);
$completed-hover: var(--k-card-completed-hover);

$header-offline: var(--k-header-offline);
$header-online: var(--k-header-online);

$btn-primary-bg: var(--k-btn-primary-bg);
$btn-primary-ink: var(--k-btn-primary-ink);
$btn-danger-bg: var(--k-btn-danger-bg);
$btn-danger-ink: var(--k-btn-danger-ink);

$radius: var(--k-radius);
$shadow: var(--k-shadow);
$space: var(--k-spacing);

@mixin safe-areas {
  padding-top: 16px;
  padding-bottom: 16px;
  padding-top: calc(16px + env(safe-area-inset-top));
  padding-bottom: calc(16px + env(safe-area-inset-bottom));
}
@mixin fluid($min,$vw,$max) { font-size: clamp($min, $vw, $max); }

/* ─────────────────────────────────────────────────────────
   Layout
   ───────────────────────────────────────────────────────── */
.kitchen-dashboard {
  background: $bg;
  color: $text;
  padding: clamp(1rem, 2vw, 2rem);
  min-height: 100dvh;
  box-sizing: border-box;
  @include safe-areas;
}

/* Simple toolbar anchored top-right for zoom controls */
.k-toolbar {
  position: sticky;
  top: 0;
  display: flex;
  gap: .5rem;
  justify-content: flex-end;
  margin-bottom: .5rem;
  z-index: 2;
}
.k-toolbar .btn { border-width: 2px; font-weight: 700; }

/* Grid layout for order cards with fixed tile size */
.kitchen-dashboard .dashboard-section .row.g-4 {
  display: grid;
  grid-template-columns: repeat(auto-fill, var(--k-card-w, 360px));
  gap: 1rem;
  /* Center the grid tracks so leftover space is split left/right */
  justify-content: center;
  align-content: start;
  align-items: start;
  margin-left: 0 !important;
  margin-right: 0 !important;
}

/* iPad-friendly widths: shrink tile to fit 4 columns */
@media (max-width: 1024px) {
  .kitchen-dashboard { --k-card-w: 230px !important; }
}
@media (min-width: 1025px) and (max-width: 1200px) {
  .kitchen-dashboard { --k-card-w: 250px !important; }
}


.section-header .section-title,
.section-header h3 {
  @include fluid(1.25rem, 3vw, 2.5rem);
  font-weight: 700;
  color: $text;
  display: inline-block;
  padding-bottom: .4rem;
  border-bottom: 4px solid $brand;
  margin-bottom: 1.25rem;
  letter-spacing: .02em;
}
.section--inprogress .section-header .section-title { color: var(--k-title-inprogress); }
.section--completed .section-header .section-title { color: var(--k-title-completed); }

.section-header .order-count {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-left: .6rem;
  background: $brand;
  color: $brand-ink;
  border-radius: 999px;
  padding: .15rem .6rem;
  font-weight: 700;
  line-height: 1;
  box-shadow: 0 2px 6px rgba(0,0,0,0.12);
}

/* ─────────────────────────────────────────────────────────
   Order card
   ───────────────────────────────────────────────────────── */
.order-card {
  border-radius: $radius;
  box-shadow: $shadow;
  overflow: hidden;
  background: $surface;
  display: flex;
  flex-direction: column;
  transition: transform .2s ease, box-shadow .2s ease;
  width: var(--k-card-w, 360px);
  height: var(--k-card-h, 520px);
}

/* scale wrapper keeps layout size constant while scaling content */
.order-card__scale {
  transform: scale(var(--k-content-scale, 1));
  transform-origin: top left;
  width: calc(100% / var(--k-content-scale, 1));
  height: calc(100% / var(--k-content-scale, 1));
}
.order-card:hover { transform: translateY(-2px); box-shadow: 0 16px 40px rgba(0,0,0,0.18); }

.order-card--inprogress { background: $inprogress; }
.order-card--inprogress:hover { background: $inprogress-hover; }

/* ✅ Completed cards: full brand green with readable ink */
.order-card--completed { background: $completed !important; }
.order-card--completed:hover { background: $completed-hover !important; }

/* header */
.order-card__header {
  padding: .85rem 1rem;
  display: flex;
  align-items: flex-start;
  gap: .75rem;
  position: relative;
  border: 0;
}
.order-card__header.bg-secondary { background: $header-offline !important; }
.order-card__header.bg-secondary-online { background: $header-online !important; }

/* Completed: remove blue strip, use dark ink on green */
.order-card--completed .order-card__header {
  background: transparent !important;
  color: var(--k-completed-ink);
}

/* top-right action: mark all ready */
.order-card__complete-all {
  position: absolute;
  top: .5rem;
  right: .5rem;
  padding: .4rem .6rem;
  line-height: 1;
  border-width: 2px;
  font-weight: 800;
  border-color: var(--k-btn-primary-bg);
  background: var(--k-btn-primary-bg);
  color: var(--k-btn-primary-ink);
  box-shadow: 0 2px 6px rgba(0,0,0,0.15);
}
.order-card__complete-all i { font-size: 16px; }
.order-card__complete-all:hover,
.order-card__complete-all:focus {
  filter: brightness(0.95);
  box-shadow: 0 3px 8px rgba(0,0,0,0.20);
}
.order-card--completed .order-card__complete-all { display: none; }

/* badge (icon) */
.order-card__type-badge {
  position: absolute;
  top: .65rem;
  left: .75rem;
  width: 30px;
  height: 30px;
  border-radius: 9999px;
  background: rgba(255,255,255,0.88);
  color: #0b1220;
  font-weight: 800;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  line-height: 1;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.5);
}
.order-card__type-badge i { font-size: 14px; }
/* On completed: white badge + dark ink looks best on green */
.order-card--completed .order-card__type-badge { background: #ffffff; color: var(--k-completed-ink); }

/* header meta */
.order-card__meta { color: #ffffff; padding-left: 2.6rem; }
.order-card__newlines-group {
  margin-top: .45rem;
  display: flex;
  flex-wrap: wrap;
  gap: .35rem;
}
.order-card__newbadge {
  display: inline-flex;
  align-items: center;
  gap: .3rem;
  padding: .25rem .55rem;
  border-radius: 9999px;
  background: rgba(255, 194, 120, 0.92);
  color: #7c2d12;
  font-weight: 600;
  font-size: .75rem;
  letter-spacing: .35px;
  box-shadow: inset 0 1px 0 rgba(255,255,255,0.45);
}
.order-card__newbadge-qty {
  font-weight: 800;
  font-size: .85rem;
}
.order-card__newbadge-name {
  font-size: .75rem;
}
.order-card__newbadge-note {
  font-size: .7rem;
  opacity: .75;
}
.order-card--completed .order-card__newbadge {
  background: rgba(255,255,255,0.85);
  color: var(--k-completed-ink);
  box-shadow: none;
}

/* Completed: dark ink instead of white */
.order-card--completed .order-card__meta { color: var(--k-completed-ink); }

/* order number (white, not bold) */
.order-card__code {
  color: #ffffff;
  font-weight: 500;
  letter-spacing: .2px;
  font-size: clamp(1.3rem, 2.1vw, 1.8rem);
  margin: 0 0 .25rem 0;
}
/* Completed: dark ink on green */
.order-card--completed .order-card__code { color: var(--k-completed-ink); }

.order-card__partner,
.order-card__posref { font-weight: 600; opacity: .95; }
.order-card__floor { margin-top: .15rem; opacity: .9; }
.order-card__floor i { margin-right: .35rem; }

/* ─────────────────────────────────────────────────────────
   Order lines
   ───────────────────────────────────────────────────────── */
.order-card__items { background: transparent; }
.order-card__item,
.order-card__items .list-group-item {
  background: var(--k-line-bg) !important;
  color: var(--k-line-color) !important;
  border-left: 0 !important;
  border-right: 0 !important;
  border-top: 1px solid var(--k-line-border) !important;
  border-bottom: 0 !important;
  padding: .85rem 1rem;
  display: flex;
  align-items: center;
  gap: .75rem;
  cursor: pointer;
  /* subtle entrance for each row */
  animation: k-row-in .25s ease both;
}
/* Make lines scroll within fixed card */
.order-card .list-group,
.order-card__items {
  flex: 1 1 auto;
  min-height: 0; /* allow flex child to shrink for overflow */
  overflow-y: auto;
}
.order-card__items .list-group-item { min-height: 44px; }
/* On completed cards, let rows inherit the green surface */
.order-card--completed .order-card__item,
.order-card--completed .order-card__items .list-group-item {
  background: transparent !important;
  color: var(--k-completed-ink) !important;
  border-color: rgba(0,0,0,0.15) !important;
}

.order-card__qty {
  min-width: 34px;
  text-align: center;
  font-weight: 800;
  color: #ffffff;
  background: rgba(0,0,0,0.35);
  border-radius: 999px;
  padding: .1rem .5rem;
}
/* qty on green stays legible */
.order-card--completed .order-card__qty { background: rgba(0,0,0,0.20); color: #ffffff; }

.order-card__product { flex: 1 1 auto; font-weight: 600; }
.order-card__note { display: block; color: var(--k-muted); margin-left: auto; }
.order-card__note i { margin-right: .35rem; }
/* row icon subtle pop on completion */
.order-card__item i.fa { transition: transform .18s ease; }

/* Per-item completion visuals */
.order-card__item.completed .order-card__product { text-decoration: line-through; opacity: .7; }
.order-card__item.completed .order-card__qty { background: rgba(40,167,69,.9); color: #fff; }
.order-card__item.completed i.fa { transform: scale(1.05); }
/* brief background highlight when an item completes */
.order-card__item.completed {
  animation: k-row-in .25s ease both, k-line-complete .32s ease-out;
}

/* Modifiers are non-interactive, keep full readability */
.order-card__item.modifier {
  cursor: default;
  opacity: 1;
  padding-left: calc(var(--k-line-padding, 1.1rem) + 18px);
}
.order-card__item.modifier .order-card__qty {
  visibility: hidden;
  width: 18px;
}
.order-card__item.modifier .order-card__product {
  font-weight: 500;
}
/* Topping text: slightly smaller, clearly readable, indented */
.order-card__item.modifier .modifier-info {
  display: block;
  color: var(--k-muted);
  font-size: 0.88em;
  padding-left: 18px;
  position: relative;
}
.order-card__item.modifier .modifier-info::before {
  content: '>';
  position: absolute;
  left: 0;
  top: 0;
  color: var(--k-muted);
}

/* Divider between pending and completed item groups */
.order-card__divider {
  background: transparent !important;
  color: var(--k-muted) !important;
  border-top: 1px dashed var(--k-line-border) !important;
  border-bottom: 0 !important;
  padding: .5rem 1rem;
  font-size: .85rem;
  display: flex;
  align-items: center;
  gap: .45rem;
  cursor: default;
}

/* footer / actions */
/* footer / actions (responsive + compact) */
.order-card__footer {
  background: transparent;
  border-top: 1px solid rgba(0,0,0,0.06);
  padding: .85rem;
}
:root[data-theme="dark"] .order-card__footer { border-top: 1px solid rgba(255,255,255,0.07); }
.order-card--completed .order-card__footer { border-top-color: rgba(0,0,0,0.15); }

/* Make actions flexible and allow shrinking */
.order-card {
  container-type: inline-size; /* enables container queries based on card width */
}
.order-card__actions {
  display: flex;                /* keep Bootstrap d-flex behaviour */
  gap: .75rem;
  align-items: stretch;
}
.order-card__actions .btn {
  flex: 1 1 0;                  /* let both buttons share space and shrink */
  min-width: 0;                 /* allow shrinking below content width */
  border-width: 2px;
  font-weight: 700;
  letter-spacing: .2px;
  padding: clamp(.5rem, 1.2vw, .65rem) clamp(.75rem, 2vw, 1rem);
  font-size: clamp(.9rem, 1.4vw, 1rem);
}

/* Colors stay as you defined */
.order-card__actions .btn.btn-primary {
  background: var(--k-btn-primary-bg);
  color: var(--k-btn-primary-ink);
  border-color: var(--k-btn-primary-bg);
}
.order-card__actions .btn.btn-primary:hover {
  background: transparent;
  color: var(--k-btn-primary-bg);
}
.order-card__actions .btn.btn-outline-danger {
  color: var(--k-btn-danger-bg);
  border-color: var(--k-btn-danger-bg);
  background: transparent;
}
.order-card__actions .btn.btn-outline-danger:hover {
  background: var(--k-btn-danger-bg);
  color: var(--k-btn-danger-ink);
}

/* ⬇️ Stack buttons when the card is narrow (container query) */
@container (max-width: 360px) {
  .order-card__actions { flex-direction: column; }
  .order-card__actions .btn { width: 100%; }
}

/* ⬇️ Fallback for browsers without container queries */
@media (max-width: 420px) {
  .order-card__actions { flex-direction: column; }
  .order-card__actions .btn { width: 100%; }
}


/* ─────────────────────────────────────────────────────────
   Confirmation popup / animations / responsive / RTL
   ───────────────────────────────────────────────────────── */
/* confirmation-popup removed with cancel flow */

@keyframes popupIn { from { opacity: 0; transform: translateY(8px) scale(0.98); } to { opacity: 1; transform: translateY(0) scale(1); } }
.fade-in { animation: fadeIn .4s ease-out; }
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

@media (max-width: 992px) {
  .order-card__code { font-size: 1.35rem; }
  .order-card__item { padding: .75rem .9rem; }
}
@media (max-width: 768px) {
  .section-header .section-title { font-size: 1.5rem; }
  .order-card { border-radius: 14px; }
}

[dir="rtl"] .order-card__type-badge { left: auto; right: .75rem; }
[dir="rtl"] .order-card__meta { padding-left: 0; padding-right: 2.6rem; }

/* Keyframes and subtle stagger */
@keyframes k-row-in {
  from { opacity: 0; transform: translateY(6px); }
  to   { opacity: 1; transform: translateY(0); }
}

@keyframes k-line-complete {
  0%   { background-color: rgba(193, 217, 99, 0.35); }
  100% { background-color: transparent; }
}

/* Stagger first rows for a gentle cascade */
.order-card__items .list-group-item:nth-child(1) { animation-delay: .00s; }
.order-card__items .list-group-item:nth-child(2) { animation-delay: .03s; }
.order-card__items .list-group-item:nth-child(3) { animation-delay: .06s; }
.order-card__items .list-group-item:nth-child(4) { animation-delay: .09s; }
.order-card__items .list-group-item:nth-child(5) { animation-delay: .12s; }
.order-card__items .list-group-item:nth-child(6) { animation-delay: .15s; }
.order-card__items .list-group-item:nth-child(7) { animation-delay: .18s; }
.order-card__items .list-group-item:nth-child(8) { animation-delay: .21s; }

/* Respect users who prefer reduced motion */
@media (prefers-reduced-motion: reduce) {
  .kitchen-dashboard * {
    animation: none !important;
    transition: none !important;
  }
}

/* Completed card subtle flash when moved */
.section--completed .order-card {
  animation: k-card-pulse .42s ease-out;
}
@keyframes k-card-pulse {
  0%   { transform: scale(0.985); box-shadow: 0 0 0 rgba(193,217,99,0.0); }
  60%  { transform: scale(1.005); box-shadow: 0 0 0 rgba(193,217,99,0.0); }
  100% { transform: scale(1.0); box-shadow: var(--k-shadow); }
}
